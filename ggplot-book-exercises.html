<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-03-08 Mon 10:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My Solutions to Exercises in "ggplot2"</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Steve Dunbar" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">My Solutions to Exercises in "ggplot2"</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0893a23">1. Chapter 2  &#x2013; First Steps</a>
<ul>
<li><a href="#orgcd80977">1.1. 2.2.1 Exercises</a></li>
<li><a href="#org17e5fb8">1.2. 2.3.1 Exercises</a></li>
<li><a href="#org22f6970">1.3. 2.4.1 Exercises</a></li>
<li><a href="#org9b54ce8">1.4. 2.5.1 Exercises</a></li>
<li><a href="#org58cab59">1.5. 2.6.6 Exercises</a></li>
</ul>
</li>
<li><a href="#orgde1352f">2. Chapter 3  &#x2013; Individual geoms</a>
<ul>
<li><a href="#org49c66c3">2.1. Section 3.1.1 Exercises</a></li>
</ul>
</li>
<li><a href="#org2b499f2">3. Chapter 4  &#x2013; Collective Geoms</a>
<ul>
<li><a href="#org090f65c">3.1. 4.5 Exercises</a></li>
</ul>
</li>
<li><a href="#org07e665c">4. Chapter 5  &#x2013; Statistical Summaries</a>
<ul>
<li><a href="#org669d46e">4.1. 5.4.1 Exercises</a></li>
</ul>
</li>
<li><a href="#org6b72a97">5. Chapter 10 &#x2013; Position Scales and axes</a>
<ul>
<li><a href="#org5cdcdba">5.1. 10.1.4 Exercises</a></li>
<li><a href="#orgad409ca">5.2. 10.1.8 Exercises</a></li>
</ul>
</li>
<li><a href="#orgdb3a9a9">6. Chapter 11 &#x2013; Colour Scales and legends</a>
<ul>
<li><a href="#orgac9dfd4">6.1. 11.3.4 Exercises</a></li>
<li><a href="#orgf509f52">6.2. 11.7.5 Exercises</a></li>
</ul>
</li>
<li><a href="#org664a560">7. Chapter 14 &#x2013; Build a plot layer by layer</a>
<ul>
<li><a href="#org40a5a50">7.1. 14.3.1  Exercises</a></li>
<li><a href="#orgc87a8a7">7.2. 14.4.3 Exercises</a></li>
<li><a href="#org7a9ca0e">7.3. 14.5.1 Exercises</a></li>
<li><a href="#orga656c95">7.4. 14.6.2 Exercises</a></li>
<li><a href="#org8a41fa3">7.5. 14.7.1 Exercises</a></li>
</ul>
</li>
<li><a href="#orgf28a84c">8. Chapter 15 &#x2013; Scales and guides</a>
<ul>
<li><a href="#orgf586d5d">8.1. 15.1.1  Exercises</a></li>
<li><a href="#org528e266">8.2. 15.7 Exercises</a></li>
</ul>
</li>
<li><a href="#orga1291fe">9. Chapter 17 &#x2013; Faceting</a>
<ul>
<li><a href="#org472ebb6">9.1. 17.7 Exercises</a></li>
</ul>
</li>
<li><a href="#org9494b36">10. Chapter 18 &#x2013; Themes</a>
<ul>
<li><a href="#orgf3fa3d1">10.1. 18.2.1 Exercises</a></li>
<li><a href="#org26f0856">10.2. 18.4.6 Exercises</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
-<b>- org-confirm-babel-evaluate: nil -</b>-
</p>

<p>
The following are my solutions to the on-line version of the
work-in-progress 3rd edition of <i>ggplot2: elegant graphics for data
analysis</i> by Hadley Wickham, Danielle Navarro and Thomas Lin Pedersen,
as of about March 2021.
The on-line site is <a href="https://ggplot2-book.org/">https://ggplot2-book.org/</a>
</p>

<p>
This document is an Emacs org-mode document with R code sections
exported to HTML with F. Niessen's <code>readtheorg</code> style.  In
addition to learning the Grammar of Graphics and ggplot2  by
working the exercises, it is also an exercise in creating and
exporting a document in org-mode that mixes both code and explanation.
This is my entry into literate programming and reproducible
research through the Emacs, Orgmode, and Org Babel with R ecosystem.
</p>

<p>
This document only covers most of the exercises up to
Chapter 18, since I don't have the understanding of functional
programming in the later section of Chapter 19 and beyond, and not
much need (yet) for the advanced methods. 
</p>

<div id="outline-container-org0893a23" class="outline-2">
<h2 id="org0893a23"><span class="section-number-2">1</span> Chapter 2  &#x2013; First Steps</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>

<div id="outline-container-orgcd80977" class="outline-3">
<h3 id="orgcd80977"><span class="section-number-3">1.1</span> 2.2.1 Exercises</h3>
<div class="outline-text-3" id="text-1-1">
<ol class="org-ol">
<li>List five functions that you could use to get more information
about the mpg dataset.</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">head(mpg)
tail(mpg)
str(mpg)
nrow(mpg)
ncol(mpg)
</pre>
</div>

<ol class="org-ol">
<li value="2">How can you find out what other datasets are included with ggplot2?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">data(package="ggplot2")
</pre>
</div>

<ol class="org-ol">
<li value="3"><p>
Apart from the US, most countries use fuel consumption (fuel
consumed over fixed distance) rather than fuel economy (distance
traveled with fixed amount of fuel). How could you convert cty and
hwy into the European standard of l/100km?
</p>

<p>
(62.1371192237 * mi/100 km)*(l/ 0.264172052358 gal)/mpg
 = ( 16.4148903129/mpg)* (l/100 km)
</p></li>
</ol>

<div class="org-src-container">
<pre class="src src-R">library("tidyverse")
mutate(mpg, cty_consump = 16.4148903129/cty, hwy_consump = 16.4148903129/hwy)
</pre>
</div>

<ol class="org-ol">
<li value="4">Which manufacturer has the most models in this dataset? Which model
has the most variations? Does your answer change if you remove the
redundant specification of drive train (e.g. “pathfinder 4wd”, “a4
quattro”) from the model name?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">mpg %&gt;% group_by(manufacturer) %&gt;% summarize(count=n())
</pre>
</div>

<p>
Dodge has most models
</p>
</div>
</div>

<div id="outline-container-org17e5fb8" class="outline-3">
<h3 id="org17e5fb8"><span class="section-number-3">1.2</span> 2.3.1 Exercises</h3>
<div class="outline-text-3" id="text-1-2">
<ol class="org-ol">
<li value="1">How would you describe the relationship between cty and hwy? Do
you have any concerns about drawing conclusions from that plot?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(cty, hwy)) + geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.3.1.1.png" alt="ggplot2-chap2.3.1.1.png" />
</p>
</div>

<p>
There is a strong positive correlation between the two quantities.  But
the data points seem to be regularly spaced, so it appears that the
data has been rounded to a specific degree.  Looking at the data, I
see that all values are integers, so it is clear why the scatter plot
is so regular.  It also means that some points could be doubled or
even tripled or more.
</p>

<ol class="org-ol">
<li value="2">What does <code>ggplot(mpg, aes(model, manufacturer)) + geom_point()</code>
show? Is it useful? How could you modify the data to make it more
informative?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(model, manufacturer)) + geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.3.1.2.png" alt="ggplot2-chap2.3.1.2.png" />
</p>
</div>

<p>
This does not give much good information. It's just an array of
alphabetized model names, versus who the manufacturer is.  It would be
improved with better labeling at the bottom, so it doesn't overwrite,
needs rotated model names.
</p>

<ol class="org-ol">
<li value="3">Describe the data, aesthetic mappings and layers used for
each of the following plots. You’ll need to guess a little because
you haven’t seen all the datasets and functions yet, but use your
common sense! See if you can predict what the plot will look like
before running the code.</li>
<li><code>ggplot(mpg, aes(cty, hwy)) + geom_point()</code></li>
</ol>
<p>
Scatter Plot
</p>
<ul class="org-ul">
<li><code>ggplot(diamonds, aes(carat, price)) + geom_point()</code></li>
</ul>
<p>
Messy scatter plot
</p>
<ul class="org-ul">
<li><code>ggplot(economics, aes(date, unemploy)) + geom_line()</code></li>
</ul>
<p>
Time series line
</p>
<ul class="org-ul">
<li><code>ggplot(mpg, aes(cty)) + geom_histogram()</code></li>
</ul>
<p>
Count of number of models with given city mileage per gallon.
</p>
</div>
</div>

<div id="outline-container-org22f6970" class="outline-3">
<h3 id="org22f6970"><span class="section-number-3">1.3</span> 2.4.1 Exercises</h3>
<div class="outline-text-3" id="text-1-3">
<ol class="org-ol">
<li value="1">Experiment with the colour, shape and size aesthetics. What
happens when you map them to continuous values? What about
categorical values? What happens when you use more than one
aesthetic in a plot?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, colour = displ)) +   geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.4.1,1a.png" alt="ggplot2-chap2.4.1,1a.png" />
</p>
</div>

<p>
The color scale is not broad enough, from blue to dark blue or black,
so it is hard to distinguish any trends.
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, size = displ)) +   geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.4.1.1b.png" alt="ggplot2-chap2.4.1.1b.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, shape = displ)) +   geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.4.1.1c.png" alt="ggplot2-chap2.4.1.1c.png" />
</p>
</div>
<blockquote>
<p>
Error: A continuous variable can not be mapped to shape
</p>
</blockquote>

<p>
The size scale is not broad enough
so it is hard to distinguish any trends.  The lack of color does not
help either.
</p>

<ol class="org-ol">
<li value="2">What happens if you map a continuous variable to shape? Why? What
happens if you map trans to shape? Why?</li>
</ol>

<p>
Mapping a continuous variable to a shape gives an error.
</p>
<blockquote>
<p>
Error: A continuous variable can not be mapped to shape
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, shape = displ)) +   geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.4.2.2.png" alt="ggplot2-chap2.4.2.2.png" />
</p>
</div>

<p>
Too many categories, and the shapes are hard to distinguish here.
</p>

<ol class="org-ol">
<li value="3">How is drive train related to fuel economy? How is drive train
related to engine size and class?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, color = drv)) +   geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.4.1.3.png" alt="ggplot2-chap2.4.1.3.png" />
</p>
</div>

<p>
Dive train is related to fuel economy, "f" or front wheel drive is
generally best fuel economy, 4-wheel drive and rear wheel drive are
comparable in fuel economy, with 4-wheel drive having a wider range of
values.
</p>
</div>
</div>

<div id="outline-container-org9b54ce8" class="outline-3">
<h3 id="org9b54ce8"><span class="section-number-3">1.4</span> 2.5.1 Exercises</h3>
<div class="outline-text-3" id="text-1-4">
<ol class="org-ol">
<li value="1">What happens if you try to facet by a continuous variable like hwy?
What about cyl? What’s the key difference?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, color = drv)) +   geom_point() + facet_wrap(~hwy)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.5.1.1a.png" alt="ggplot2-chap2.5.1.1a.png" />
</p>
</div>

<p>
Get many facets here each with few points.  Although hwy is a continuous value, it
appears here as integer values, so <code>facet_wrap</code> can actually handle
it.
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, color = drv)) +   geom_point() + facet_wrap(~cyl)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.5.1.1b.png" alt="ggplot2-chap2.5.1.1b.png" />
</p>
</div>

<p>
The key difference seems to be the number of values of the faceting variable.
</p>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.5.1.1b.png" alt="ggplot2-chap2.5.1.1b.png" />
</p>
</div>

<ol class="org-ol">
<li value="2">Use faceting to explore the 3-way relationship between fuel
economy, engine size, and number of cylinders. How does faceting by
number of cylinders change your assessment of the relationship
between engine size and fuel economy?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, color = drv)) +   geom_point() + facet_wrap(~cyl)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.5.1.2.png" alt="ggplot2-chap2.5.1.2.png" />
</p>
</div>

<p>
Across the factors of cylinders, fuel economy seems to depend on
cylinders somewhat.  Because of the bunching of the points for 6 and 8
cylinders, it appears that displacement does not greatly affect the
fuel economy for those classes.  However for 4 cylinders,
displacement does not affect economy much, but some other factor does
affect
</p>

<ol class="org-ol">
<li value="3">Read the documentation for <code>facet_wrap()</code>. What arguments can you use
to control how many rows and columns appear in the output?</li>
</ol>

<p>
<code>nrow</code>, <code>ncol</code>: Number of rows and columns.
</p>

<ol class="org-ol">
<li value="4">What does the scales argument to <code>facet_wrap()</code> do? When might you
use it?</li>
</ol>

<blockquote>
<p>
scales: Should scales be fixed (‘"fixed"’, the default), free
	(‘"free"’), or free in one dimension (‘"<code>free_x</code>"’,
	‘"<code>free_y</code>"’)?
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org58cab59" class="outline-3">
<h3 id="org58cab59"><span class="section-number-3">1.5</span> 2.6.6 Exercises</h3>
<div class="outline-text-3" id="text-1-5">
<ol class="org-ol">
<li value="1">One challenge with ggplot(mpg, aes(class, hwy)) + geom<sub>boxplot</sub>()
is that the ordering of class is alphabetical, which is not
terribly useful. How could you change the factor levels to be more
informative?</li>
</ol>

<p>
Probably the most automatic is to use the <code>forcats</code> library function
<code>fact_reorder()</code>.  See examples at
<a href="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html">https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html</a>
</p>

<p>
A little more hands-on is to use <code>mutate</code> to create a new variable or
reorder an existing one.  Again, see examples at
<a href="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html">https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html</a>
</p>

<ol class="org-ol">
<li value="2">Rather than reordering the factor by hand, you can do it
automatically based on the data: <code>ggplot(mpg, aes(reorder(class,
   hwy), hwy)) + geom_boxplot()</code>. What does <code>reorder()</code> do? Read the
documentation.</li>
</ol>

<p>
From the documentation:
</p>
<blockquote>
<p>
‘reorder’ is a generic function.  The ‘"default"’ method treats
     its first argument as a categorical variable, and reorders its
     levels based on the values of a second variable, usually numeric.
reorder is in the stats library
</p>
</blockquote>

<ol class="org-ol">
<li value="3">Explore the distribution of the carat variable in the diamonds
dataset. What binwidth reveals the most interesting patterns?</li>
</ol>

<p>
This exercise is basically repeated in Exercise 5.4.1.1.  The answer
there is:
 The default binwidth seems to give too coarse a distribution but there
 may be something interesting happening near 1 and 2
</p>

<p>
A binwidth= 0.1 starts to reveal a mix of decaying exponential
distributions at 1/2, 1, 2 maybe 3
</p>

<p>
Finally, with a binwidth of 0.005, some clear trends appear with a mix
of decaying exponentials appearing at about multiples of  0.25 carats.
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(carat) ) +
    geom_histogram(binwidth= 0.005) +
    xlim(0,2.5)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.6.6.3.png" alt="ggplot2-chap2.6.6.3.png" />
</p>
</div>

<ol class="org-ol">
<li value="4">Explore the distribution of the price variable in the diamonds
data. How does the distribution vary by cut?</li>
</ol>

<p>
This exercise is basically repeated in Exercise 16.7.1.  The answer
there is:
 The default binwidth seems to give too coarse a distribution but there
 may be something interesting happening near 1 and 2
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(carat, price)) +
  geom_point() +
  facet_wrap( ~cut)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.6.6.4.png" alt="ggplot2-chap2.6.6.4.png" />
</p>
</div>

<ol class="org-ol">
<li value="5">You now know (at least) three ways to compare the distributions
of subgroups: <code>geom_violin()</code>, <code>geom_freqpoly()</code> and the colour
aesthetic, or <code>geom_histogram()</code> and faceting. What are the strengths
and weaknesses of each approach? What other approaches could you
try?</li>

<li><code>geom_violin()</code>:  Strength:  Ability to compare more than a few</li>
</ol>
<p>
distributions.
Weakness:  Hard to distinguish details on the small plots.
</p>

<ul class="org-ul">
<li><code>geom_freqpoly()</code>:  Strength:  Matches the common visualization of a</li>
</ul>
<p>
distribution as a frequency on the vertical versus the variable on the
horizontal axis.
Weakness: The overlapping distributions sometimes hide each other and
obscure details.  
</p>

<ul class="org-ul">
<li><code>geom_histogram()</code>:  Strength:  Details are revealed for each</li>
</ul>
<p>
subgroup. Weakness: hard to compare one subgroup to another.
</p>

<ol class="org-ol">
<li value="6">Read the documentation for <code>geom_bar()</code>. What does the weight
aesthetic do?</li>
</ol>

<p>
There are two types of bar charts: <code>geom_bar()</code> and
<code>geom_col()</code>. <code>geom_bar()</code> makes the height of the bar proportional to the
number of cases in each group (or if the weight aesthetic is supplied,
the sum of the weights).
</p>

<ol class="org-ol">
<li value="7">Using the techniques already discussed in this chapter, come up
with three ways to visualise a 2d categorical distribution. Try
them out by visualising the distribution of model and manufacturer,
trans and class, and cyl and trans.</li>
</ol>


<p>
The following is a start for trans and class:
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot( mpg, aes(x = trans)) + geom_bar(aes(fill=class))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap2.6.6.7.png" alt="ggplot2-chap2.6.6.7.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgde1352f" class="outline-2">
<h2 id="orgde1352f"><span class="section-number-2">2</span> Chapter 3  &#x2013; Individual geoms</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>


<div id="outline-container-org49c66c3" class="outline-3">
<h3 id="org49c66c3"><span class="section-number-3">2.1</span> Section 3.1.1 Exercises</h3>
<div class="outline-text-3" id="text-2-1">
<ol class="org-ol">
<li value="1"><p>
What geoms would you use to draw each of the following named plots?
</p>
<ul class="org-ul">
<li>Scatterplot &#x2013; <code>geom_point()</code></li>
<li>Line chart &#x2013; <code>geom_line()</code></li>
<li>Histogram &#x2013; <code>geom_histogram()</code></li>
<li>Bar chart &#x2013; <code>geom_bar()</code></li>
<li>Pie chart &#x2013; The function <code>coord_polar()</code> is used to produce a</li>
</ul>
<p>
pie chart, which is just a stacked bar chart in polar coordinates.
</p></li>
</ol>

<p>
An example would be
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(df, aes(x="", y=value, fill=group))+
geom_bar(width = 1, stat = "identity")
+ coord_polar("y", start=0)
</pre>
</div>


<ol class="org-ol">
<li value="2">What’s the difference between <code>geom_path()</code> and <code>geom_polygon()</code>?
What’s the difference between <code>geom_path()</code> and <code>geom_line()</code>?</li>
</ol>

<p>
Polygons are very similar to paths (as drawn by <code>geom_path()</code>) except
that the start and end points are connected and the inside is coloured
by ‘fill’. The ‘group’ aesthetic determines which cases are connected
together into a polygon. From R 3.6 and onwards it is possible to draw
polygons with holes by providing a subgroup aesthetic that
differentiates the outer ring points from those describing holes in
the polygon.
</p>

<ol class="org-ol">
<li value="3">What low-level geoms are used to draw <code>geom_smooth()</code>? What about
<code>geom_boxplot()</code> and <code>geom_violin()</code>?</li>
</ol>

<p>
Probably each uses <code>geom_line()</code> but I don't find documentation of this.
I have to look into the function code to find out.
</p>

<p>
Scanning the code for <code>geom_violin()</code>, at 
<a href="https://github.com/tidyverse/ggplot2/blob/master/R/geom-violin.r">https://github.com/tidyverse/ggplot2/blob/master/R/geom-violin.r</a>
I find some references to drawing paths and polygons, but not with the
higher level geoms, more like more primitive drawing tools.
</p>

<p>
Looking closer the source, at line 177, I find <code>draw_panel()</code>.
Following up, in the vignette "Extending ggplot2", 
<a href="https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html">https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html</a>
I find
</p>
<blockquote>
<p>
<code>draw_panel()</code> is where the magic happens. This function takes three
arguments and returns a grid grob. It is called once for each
panel. 
</p>
</blockquote>
<p>
A "grob" is a grid graphical object in R.
</p>
</div>
</div>
</div>

<div id="outline-container-org2b499f2" class="outline-2">
<h2 id="org2b499f2"><span class="section-number-2">3</span> Chapter 4  &#x2013; Collective Geoms</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>

<div id="outline-container-org090f65c" class="outline-3">
<h3 id="org090f65c"><span class="section-number-3">3.1</span> 4.5 Exercises</h3>
<div class="outline-text-3" id="text-3-1">
<ol class="org-ol">
<li value="1"><p>
Draw a boxplot of hwy for each value of cyl, without turning cyl
into a factor. What extra aesthetic do you need to set?
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(cyl, hwy, group=cyl)) + geom_boxplot()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap4.5.1.png" alt="ggplot2-chap4.5.1.png" />
</p>
</div></li>

<li value="2"><p>
Modify the following plot so that you get one boxplot per integer value of displ.
</p>

<div class="org-src-container">
<pre class="src src-:export">ggplot(mpg, aes(displ, cty)) + 
	   geom_boxplot()
</pre>
</div>

<p>
Amazingly, the following, which was a guess, worked!
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, cty, group = round(displ))) + 
  geom_boxplot()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap4.5.2.png" alt="ggplot2-chap4.5.2.png" />
</p>
</div></li>

<li value="3"><p>
When illustrating the difference between mapping continuous and
discrete colours to a line, the discrete example needed <code>aes(group
   = 1)</code>. Why? What happens if that is omitted? What’s the difference
between <code>aes(group = 1)</code> and <code>aes(group = 2)</code>? Why?
</p>

<p>
If <code>group = 1</code> is omitted from the <code>geom_line()</code>, then get the following
error message:
</p></li>
</ol>
<blockquote>
<p>
<code>geom_path</code>: Each group consists of only one observation. Do you need to adjust
the group aesthetic?
</p>
</blockquote>

<p>
There is no difference that I can see  between <code>aes(group = 1)</code> and
<code>aes(group = 2)</code>.  Even if I try <code>aes(group=5)</code> the graphic is the same.
I am not sure why this should be.
</p>

<ol class="org-ol">
<li value="4"><p>
How many bars are in each of the following plots?
</p>

<div class="org-src-container">
<pre class="src src-:export">ggplot(mpg, aes(drv)) +
    geom_bar()
</pre>
</div>

<p>
3 bars, one each for "4", "f", "r".
</p>

<div class="org-src-container">
<pre class="src src-:export">ggplot(mpg, aes(drv, fill = hwy, group = hwy)) +
   geom_bar()
</pre>
</div>

<p>
3 bars, one each for "4", "f", "r", but now are shaded colour by hwy.
</p>

<div class="org-src-container">
<pre class="src src-:export">library(dplyr)  
    mpg2 &lt;- mpg %&gt;% arrange(hwy) %&gt;% mutate(id = seq_along(hwy)) 
    ggplot(mpg2, aes(drv, fill = hwy, group = id)) + 
    geom_bar()
</pre>
</div>

<p>
(Hint: try adding an outline around each bar with colour = "white")
</p></li>

<li value="5"><p>
Install the babynames package. It contains data about the
popularity of babynames in the US. Run the following code and fix
the resulting graph. Why does this graph make me unhappy?
</p>

<div class="org-src-container">
<pre class="src src-R">library(babynames)
hadley &lt;- dplyr::filter(babynames, name == "Hadley")
ggplot(hadley, aes(year, n)) + 
  geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap4.5.5a.png" alt="ggplot2-chap4.5.5a.png" />
</p>
</div>

<p>
The following is better:
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(hadley, aes(year, n, color=sex)) +
  geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap4.5.5b.png" alt="ggplot2-chap4.5.5b.png" />
</p>
</div>

<p>
In either case, "Hadley" is clearly a popular female name in the 21st
Century.
</p></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org07e665c" class="outline-2">
<h2 id="org07e665c"><span class="section-number-2">4</span> Chapter 5  &#x2013; Statistical Summaries</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>


<div id="outline-container-org669d46e" class="outline-3">
<h3 id="org669d46e"><span class="section-number-3">4.1</span> 5.4.1 Exercises</h3>
<div class="outline-text-3" id="text-4-1">
<ol class="org-ol">
<li value="1"><p>
What binwidth tells you the most interesting story about the
distribution of carat?
</p>

<p>
The default binwidth seems to give too coarse a distribution but there
may be something interesting happening near 1 and 2
</p>

<p>
A <code>binwidth= 0.1</code> starts to reveal a mix of decaying exponential
distributions at 1/2, 1, 2 maybe 3
</p>

<p>
Finally, with a binwidth of 0.005, some clear trends appear with a mix
of decaying exponentials appearing at about multiples of  0.25 carats.
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(carat) ) +
    geom_histogram(binwidth= 0.005) +
    xlim(0,2.5)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap5.4.1.1.png" alt="ggplot2-chap5.4.1.1.png" />
</p>
</div></li>

<li value="2"><p>
Draw a histogram of price. What interesting patterns do you see?
</p>

<p>
Roughly speaking an exponential type drop as price increases
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot( diamonds, aes(price) ) +
    geom_histogram(binwidth=200)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap5.4.1.2.png" alt="ggplot2-chap5.4.1.2.png" />
</p>
</div></li>

<li value="3"><p>
How does the distribution of price vary with clarity?
</p>

<p>
Long tails on the distribution, more or less similar for all values
of clarity.
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(factor(clarity), price) ) +
    geom_violin()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap5.4.1.3.png" alt="ggplot2-chap5.4.1.3.png" />
</p>
</div></li>

<li value="4">Overlay a frequency polygon and density plot of depth. What
computed variable do you need to map to y to make the two plots
comparable? (You can either modify <code>geom_freqpoly()</code> or
<code>geom_density()</code>.)</li>
</ol>

<p>
No solution.
</p>
</div>
</div>
</div>

<div id="outline-container-org6b72a97" class="outline-2">
<h2 id="org6b72a97"><span class="section-number-2">5</span> Chapter 10 &#x2013; Position Scales and axes</h2>
<div class="outline-text-2" id="text-5">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>

<div id="outline-container-org5cdcdba" class="outline-3">
<h3 id="org5cdcdba"><span class="section-number-3">5.1</span> 10.1.4 Exercises</h3>
<div class="outline-text-3" id="text-5-1">
<ol class="org-ol">
<li value="1">The following code creates two plots of the mpg dataset. Modify
the code so that the legend and axes match, without using
faceting!</li>
</ol>

<div class="org-src-container">
<pre class="src src-:exports">fwd &lt;- subset(mpg, drv == "f")
rwd &lt;- subset(mpg, drv == "r")

ggplot(fwd, aes(displ, hwy, colour = class)) + geom_point()
ggplot(rwd, aes(displ, hwy, colour = class)) + geom_point()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">fwd &lt;- subset(mpg, drv == "f")
rwd &lt;- subset(mpg, drv == "r")
ggplot(fwd, aes(displ, hwy, colour = class)) +
    geom_point() +
    xlim(2,7) + ylim(15, 45) +
    scale_color_discrete(limits =
     c("compact", "midsize", "minivan", "subcompact", "2seater", "suv"))
ggplot(rwd, aes(displ, hwy, colour = class)) +
    geom_point() +
    xlim(2,7) + ylim(15, 45) +
    scale_color_discrete(limits =
     c("compact", "midsize", "minivan", "subcompact", "2seater", "suv"))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap10.1.4.2.png" alt="ggplot2-chap10.1.4.2.png" />
</p>
</div>


<ol class="org-ol">
<li value="2"><p>
What happens if you add two <code>xlim()</code> calls to the same plot? Why?
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(rwd, aes(displ, hwy, colour = class)) +
    geom_point() +
    xlim(2,7) + xlim(5, 6)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap10.1.4.2.png" alt="ggplot2-chap10.1.4.2.png" />
</p>
</div>

<p>
Get the following error message:
</p></li>
</ol>
<blockquote>
<p>
Scale for 'x' is already present. Adding another scale for 'x', which will
replace the existing scale.
Warning message:
Removed 12 rows containing missing values '(geom<sub>point</sub>)'. 
</p>
</blockquote>

<p>
The second scale is used, replaces the first scale.
</p>


<ol class="org-ol">
<li value="3"><p>
What does <code>scale_x_continuous(limits = c(NA, NA))</code> do?
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(fwd, aes(displ, hwy, colour = class)) +
    geom_point() +
    xlim(NA, NA)
</pre>
</div>
<p>
gives the following error message (which I don't find very
helpful!)
</p></li>
</ol>
<blockquote>
<p>
Error in UseMethod("limits") : 
no applicable method for 'limits' applied to an object of class "logical"
</p>
</blockquote>

<p>
However the following works!
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(fwd, aes(displ, hwy, colour = class)) +
    geom_point() +
    xlim(NA, 7)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap10.1.4.3.png" alt="ggplot2-chap10.1.4.3.png" />
</p>
</div>

<ol class="org-ol">
<li value="4"><p>
What does <code>expand_limits()</code> do and how does it work? Read the source
code.
</p>

<p>
Sometimes you may want to ensure limits include a single value, for
all panels or all plots. This function <code>expand_limit()</code> is a thin wrapper around
<code>geom_blank()</code> that makes it easy to add such values.  This function
seems to me to do essentially the same this as <code>xlim()</code> and <code>ylim()</code>.
This function can be used to quickly set the intercept of x and y axes at (0,0)
and to expand the limits of x and y axes.
</p>

<p>
The source code is:
</p>
<div class="org-src-container">
<pre class="src src-R">{
    data &lt;- list(...)
    data_dfs &lt;- vapply(data, is.data.frame, logical(1))
    data &lt;- do.call(c, c(list(data[!data_dfs]), data[data_dfs]))
    n_rows &lt;- max(vapply(data, length, integer(1)))
    data &lt;- lapply(data, rep, length.out = n_rows)
    data &lt;- new_data_frame(data)
    geom_blank(aes_all(names(data)), data, inherit.aes = FALSE)
}
</pre>
</div>

<p>
It's not clear to me what all this does, but it looks like the
function increases the data and adds a new invisible or blank geom to
the plot.
</p></li>
</ol>
</div>
</div>


<div id="outline-container-orgad409ca" class="outline-3">
<h3 id="orgad409ca"><span class="section-number-3">5.2</span> 10.1.8 Exercises</h3>
<div class="outline-text-3" id="text-5-2">
<ol class="org-ol">
<li value="1"><p>
Recreate the following graphic:
Adjust the y axis label so that the parentheses are the right size.
</p>

<p>
The following does it, but without the stacked fraction.  It is not
clear how to format this, but the following might help.
<a href="https://www.benjaminackerman.com/post/2019-03-08-equation_labels/">https://www.benjaminackerman.com/post/2019-03-08-equation_labels/</a>
and
<a href="https://astrostatistics.psu.edu/su07/R/html/grDevices/html/plotmath.html">https://astrostatistics.psu.edu/su07/R/html/grDevices/html/plotmath.html</a>
See also
<a href="https://stackoverflow.com/questions/40994357/notation-for-fractions-divides-by-or-over-in-r-and-ggplot2">https://stackoverflow.com/questions/40994357/notation-for-fractions-divides-by-or-over-in-r-and-ggplot2</a>
It looks like I need <code>expression()</code>,  see question 3 below.
</p></li>
</ol>

<div class="org-src-container">
<pre class="src src-R">base  &lt;-  ggplot(mpg, aes(displ, hwy)) +
    geom_point()
base +
    xlab("Displacement") +
    ylab("Highway (miles/gallon)")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap10.1.8.1.png" alt="ggplot2-chap10.1.8.1.png" />
</p>
</div>

<ol class="org-ol">
<li value="2"><p>
List the three different types of object you can supply to the
breaks argument. How do breaks and labels differ?
</p>

<p>
From the online documentation at
<a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">https://ggplot2.tidyverse.org/reference/scale_continuous.html</a>
'breaks' can be set to one of:
</p>
<ul class="org-ul">
<li>NULL for no breaks</li>
<li><code>waiver()</code> for the default breaks computed by the transformation object</li>
<li>A numeric vector of positions</li>
<li>A function that takes the limits as input and returns breaks as
output (e.g., a function returned by <code>scales::extended_breaks()</code>)</li>
</ul>

<p>
'labels' can be set to one of:
</p>
<ul class="org-ul">
<li>NULL for no labels</li>
<li><code>waiver()</code> for the default labels computed by the transformation object</li>
<li>A character vector giving labels (must be same length as breaks)</li>
<li>A function that takes the breaks as input and returns labels as
output</li>
</ul>

<p>
The overall difference seems to be that breaks are numeric and
labels are characters.
</p></li>

<li value="3"><p>
What label function allows you to create mathematical expressions?
What label function converts 1 to 1st, 2 to 2nd, and so on?
</p>

<p>
From online documentation
<a href="https://ggplot2.tidyverse.org/reference/label_bquote.html">https://ggplot2.tidyverse.org/reference/label_bquote.html</a>
</p>

<blockquote>
<p>
<code>label_bquote()</code> offers a flexible way of labeling facet rows or
columns with plotmath expressions. Backquoted variables will be
replaced with their value in the facet.
</p>
</blockquote>

<p>
But this seems to be incomplete since the only examples appear to be
single Greek letters, not what I consider to be mathematical
expressions.
</p>

<p>
The <code>expression()</code> function seems to be a better alternative,
see
<a href="https://stackoverflow.com/questions/40994357/notation-for-fractions-divides-by-or-over-in-r-and-ggplot2">https://stackoverflow.com/questions/40994357/notation-for-fractions-divides-by-or-over-in-r-and-ggplot2</a>
</p>

<p>
To convert 1 to 1st, 2 to 2nd, etc, looks like I want to use the
special package toOrdinal, see
<a href="https://rdrr.io/cran/toOrdinal/man/toOrdinal.html">https://rdrr.io/cran/toOrdinal/man/toOrdinal.html</a>
and
<a href="https://cran.r-project.org/web/packages/toOrdinal/toOrdinal.pdf">https://cran.r-project.org/web/packages/toOrdinal/toOrdinal.pdf</a>
</p></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgdb3a9a9" class="outline-2">
<h2 id="orgdb3a9a9"><span class="section-number-2">6</span> Chapter 11 &#x2013; Colour Scales and legends</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>

<div id="outline-container-orgac9dfd4" class="outline-3">
<h3 id="orgac9dfd4"><span class="section-number-3">6.1</span> 11.3.4 Exercises</h3>
<div class="outline-text-3" id="text-6-1">
<ol class="org-ol">
<li value="1">Recreate the following plot.</li>
</ol>


<p>
Something like one of the following should work, but none do
</p>
<div class="org-src-container">
<pre class="src src-R">p  &lt;- ggplot(mpg, aes(displ,hwy, color=drv)) + geom_point()
p
p + scale_fill_discrete(labels=c("4wd", "fwd", "rwd"))
p + scale_fill_manual(name="Drive", labels=c("4wd", "fwd", "rwd"))
</pre>
</div>


<p>
Here's the way, with even a small additional improvement.
</p>
<div class="org-src-container">
<pre class="src src-R">p &lt;- ggplot(mpg, aes(displ,hwy, color=drv)) + geom_point()
p + scale_color_discrete(name="Drive", labels=c("4wd", "fwd", "rwd"))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap11.3.8.1.png" alt="ggplot2-chap11.3.8.1.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf509f52" class="outline-3">
<h3 id="orgf509f52"><span class="section-number-3">6.2</span> 11.7.5 Exercises</h3>
<div class="outline-text-3" id="text-6-2">
<ol class="org-ol">
<li value="1">How do you make legends appear to the left of the plot?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ,hwy, color=drv)) + geom_point() + theme(legend.position="left")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap11.7.5.1.png" alt="ggplot2-chap11.7.5.1.png" />
</p>
</div>

<ol class="org-ol">
<li value="2">What’s gone wrong with this plot? How could you fix it?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = drv, shape = drv)) + 
  scale_colour_discrete("Drive train")
</pre>
</div>


<p>
What's wrong is that the points have two aesthetics and two legends.
The fix is to combine the color and the shape into one legend.
The way to do it is to omit the <code>scale_color_discrete()</code>
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ,hwy)) + geom_point(aes(color=drv,shape=drv))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap11.7.5.2.png" alt="ggplot2-chap11.7.5.2.png" />
</p>
</div>

<ol class="org-ol">
<li value="3"><p>
Can you recreate the code for this plot?
</p>

<p>
<code>`geom_smooth()` using formula 'y ~ x'</code>
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ,hwy, color=class)) +
    geom_point() +
    geom_smooth(method="lm", se=FALSE) +
    theme(legend.position="bottom")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap11.7.5.3.png" alt="ggplot2-chap11.7.5.3.png" />
</p>
</div></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org664a560" class="outline-2">
<h2 id="org664a560"><span class="section-number-2">7</span> Chapter 14 &#x2013; Build a plot layer by layer</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>

<div id="outline-container-org40a5a50" class="outline-3">
<h3 id="org40a5a50"><span class="section-number-3">7.1</span> 14.3.1  Exercises</h3>
<div class="outline-text-3" id="text-7-1">
<ol class="org-ol">
<li value="1">The first two arguments to ggplot are data and mapping. The first
two arguments to all layer functions are mapping and data. Why does
the order of the arguments differ? (Hint: think about what you set
most commonly.)</li>

<li value="2"><p>
The following code uses dplyr to generate some summary statistics
about each class of car.
</p>

<div class="org-src-container">
<pre class="src src-R">library(dplyr)
class &lt;- mpg %&gt;% 
  group_by(class) %&gt;% 
  summarise(n = n(), hwy = mean(hwy))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">2seater</td>
<td class="org-right">5</td>
<td class="org-right">24.8</td>
</tr>

<tr>
<td class="org-left">compact</td>
<td class="org-right">47</td>
<td class="org-right">28.2978723404255</td>
</tr>

<tr>
<td class="org-left">midsize</td>
<td class="org-right">41</td>
<td class="org-right">27.2926829268293</td>
</tr>

<tr>
<td class="org-left">minivan</td>
<td class="org-right">11</td>
<td class="org-right">22.3636363636364</td>
</tr>

<tr>
<td class="org-left">pickup</td>
<td class="org-right">33</td>
<td class="org-right">16.8787878787879</td>
</tr>

<tr>
<td class="org-left">subcompact</td>
<td class="org-right">35</td>
<td class="org-right">28.1428571428571</td>
</tr>

<tr>
<td class="org-left">suv</td>
<td class="org-right">62</td>
<td class="org-right">18.1290322580645</td>
</tr>
</tbody>
</table>

<p>
#&gt; `summarise()` ungrouping output (override with `.groups` argument)
</p>

<p>
Use the data to recreate this plot:
</p></li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(class, hwy)) +
    geom_point() +
    geom_jitter(width=0.2) +
    geom_point(data=class, color="red", size=3) +
    geom_text(data=class, aes(class, 10, label=paste0("n=", n)))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.3.1.2.png" alt="ggplot2-chap14.3.1.2.png" />
</p>
</div>


<p>
Couple of notes:
</p>
<ol class="org-ol">
<li>It looks like a different size of black point may have been
specified in the plot in the exercise.</li>
<li>The red dots in the exercise may have been specified larger in the
plot for the exercise.</li>
<li>The amount of jitter may have been smaller in the
plot for the exercise, since I appear to have more discrete points
while some overlap or overplotting may appear in the exercise.</li>
</ol>
</div>
</div>

<div id="outline-container-orgc87a8a7" class="outline-3">
<h3 id="orgc87a8a7"><span class="section-number-3">7.2</span> 14.4.3 Exercises</h3>
<div class="outline-text-3" id="text-7-2">
<ol class="org-ol">
<li value="1"><p>
Simplify the following plot specifications:
</p>

<p>
a.
</p></li>
</ol>
<div class="org-src-container">
<pre class="src src-R">ggplot(mpg) + 
      geom_point(aes(mpg$displ, mpg$hwy))
</pre>
</div>

<p>
Note: The given commands give the following warnings:
</p>
<blockquote>
<p>
1: Use of `mpg$displ` is discouraged. Use `displ` instead. 
2: Use of `mpg$hwy` is discouraged. Use `hwy` instead. 
</p>
</blockquote>

<p>
The following is the simplification:
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, hwy)) +
    geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.4.3.1a.png" alt="ggplot2-chap14.4.3.1a.png" />
</p>
</div>

<p>
This gives the same plot as the unsimplified.
</p>


<p>
b.
</p>

<div class="org-src-container">
<pre class="src src-:exports">ggplot() + 
  geom_point(mapping = aes(y = hwy, x = cty), data = mpg) +
  geom_smooth(data = mpg, mapping = aes(cty, hwy))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(cty,hwy)) + geom_point() + geom_smooth() 
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.1.1.1b.png" alt="ggplot2-chap14.1.1.1b.png" />
</p>
</div>

<p>
This gives the same plot as the unsimplified.
</p>

<p>
c.
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(carat, price)) + 
      geom_point(aes(log(brainwt), log(bodywt)), data = msleep)
</pre>
</div>

<p>
The unsimplified commands above plot the msleep data on log scales,
but with the diamonds carat and price labels on the axes.
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(msleep, aes(log(brainwt), log(bodywt))) +
       geom_point()
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.4.3.1c.png" alt="ggplot2-chap14.4.3.1c.png" />
</p>
</div>

<ol class="org-ol">
<li value="2">What does the following code do? Does it work? Does it make sense? Why/why not?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg) +
  geom_point(aes(class, cty)) + 
  geom_boxplot(aes(trans, hwy))
</pre>
</div>

<p>
It overplots the class versus cty point plot with the trans versus hwy
boxplot.  The result does not make sense, it is confusing.
</p>

<ol class="org-ol">
<li value="3">What happens if you try to use a continuous variable on the x axis in
one layer, and a categorical variable in another layer? What happens
if you do it in the opposite order?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg) +
  geom_point(aes(cty, hwy)) + 
  geom_boxplot(aes(trans, hwy))
</pre>
</div>

<blockquote>
<p>
Error message: Error: Discrete value supplied to continuous scale
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg) +
  geom_boxplot(aes(trans, hwy)) +
  geom_point(aes(cty, hwy))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.4.3.3.png" alt="ggplot2-chap14.4.3.3.png" />
</p>
</div>

<p>
It plots but the plot is a mess, and the axes are cramped,
confused, and messy.
</p>
</div>
</div>


<div id="outline-container-org7a9ca0e" class="outline-3">
<h3 id="org7a9ca0e"><span class="section-number-3">7.3</span> 14.5.1 Exercises</h3>
<div class="outline-text-3" id="text-7-3">
<ol class="org-ol">
<li value="1">Download and print out the ggplot2 cheatsheet from
<a href="http://www.rstudio.com/resources/cheatsheets/">http://www.rstudio.com/resources/cheatsheets/</a>
so you have a handy visual reference for all the geoms.</li>

<li value="2"><p>
Look at the documentation for the graphical primitive geoms. Which
aesthetics do they use? How can you summarise them in a compact
form?
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>

<tr>
<th scope="col" class="org-left">Primitive</th>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">y</th>
<th scope="col" class="org-left">label</th>
<th scope="col" class="org-left">ymin</th>
<th scope="col" class="org-left">ymax</th>
<th scope="col" class="org-left">alpha</th>
<th scope="col" class="org-left">angle</th>
<th scope="col" class="org-left">color</th>
<th scope="col" class="org-left">family</th>
<th scope="col" class="org-left">fontface</th>
<th scope="col" class="org-left">fill</th>
<th scope="col" class="org-left">group</th>
<th scope="col" class="org-left">shape</th>
<th scope="col" class="org-left">width</th>
<th scope="col" class="org-left">size</th>
<th scope="col" class="org-left">linetype</th>
<th scope="col" class="org-left">subgroup</th>
<th scope="col" class="org-left">stroke</th>
</tr>

<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">xmin</th>
<th scope="col" class="org-left">xmax</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>geom_point</code></td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
</tr>

<tr>
<td class="org-left"><code>geom_path</code></td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>geom_ribbon</code></td>
<td class="org-left">1</td>
<td class="org-left">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>geom_segment</code></td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>geom_rect</code></td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>geom_polygon</code></td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>geom_text</code></td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Well, this is not as compact as I expected, since there are more
aesthetics than I expected.
</p></li>

<li value="3"><p>
What’s the best way to master an unfamiliar geom? List three
resources to help you get started.
</p>

<p>
This is a pretty facile answer:
</p>
<ul class="org-ul">
<li>Start with the built-in help file.  Identify the default values, in
particular the aesthetics, stat, position, and scale associated with
the geom.</li>
<li>Look at the online documentation from the tidyverse, since it has
more of the same.</li>
<li>Try some of the examples, especially examples which use the mpg
data set since it is so familiar, and used so often for
illustrations.</li>
<li>Look at the GGPlot2 Cookbook.</li>
<li>Look at the R Graph gallery.</li>
</ul></li>

<li value="4">For each of the plots below, identify the geom used to draw it.</li>
</ol>
<p>
a. <code>geom_violin()</code>
b. <code>geom_point()</code> with size as an aesthetic
c. <code>geom_hex()</code>
d. <code>geom_point() + geom_jitter()</code>
e. <code>geom_line()</code> apparently also with fill
f. <code>geom_path()</code>
</p>

<ol class="org-ol">
<li value="5">For each of the following problems, suggest a useful geom:</li>
</ol>

<p>
a. Display how a variable has changed over time.
</p>

<p>
I would use <code>geom_line()</code>, possibly <code>geom_path()</code>
</p>

<p>
b. Show the detailed distribution of a single variable.
</p>

<p>
I would use <code>geom_density()</code>
</p>

<p>
c. Focus attention on the overall trend in a large dataset.
</p>

<p>
I would use <code>geom_smooth</code> here
</p>

<p>
d. Draw a map.
</p>

<p>
<code>geom_polygon</code>, but you need the shapefile for the map.
</p>

<p>
e. Label outlying points.
</p>

<p>
<code>geom_text</code> after filtering to identify and isolate the outliers.
</p>
</div>
</div>


<div id="outline-container-orga656c95" class="outline-3">
<h3 id="orga656c95"><span class="section-number-3">7.4</span> 14.6.2 Exercises</h3>
<div class="outline-text-3" id="text-7-4">
<ol class="org-ol">
<li value="1">The code below creates a similar dataset to <code>stat_smooth()</code>. Use the
appropriate geoms to mimic the default <code>geom_smooth()</code> display.</li>
</ol>
<div class="org-src-container">
<pre class="src src-R">mod &lt;- loess(hwy ~ displ, data = mpg)
smoothed &lt;- data.frame(displ = seq(1.6, 7, length = 50))
pred &lt;- predict(mod, newdata = smoothed, se = TRUE) 
smoothed$hwy &lt;- pred$fit
smoothed$hwy_lwr &lt;- pred$fit - 1.96 * pred$se.fit
smoothed$hwy_upr &lt;- pred$fit + 1.96 * pred$se.fit
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">mod &lt;- loess(hwy ~ displ, data = mpg)
smoothed &lt;- data.frame(displ = seq(1.6, 7, length = 50))
pred &lt;- predict(mod, newdata = smoothed, se = TRUE) 
smoothed$hwy &lt;- pred$fit
smoothed$hwy_lwr &lt;- pred$fit - 1.96 * pred$se.fit
smoothed$hwy_upr &lt;- pred$fit + 1.96 * pred$se.fit
ggplot(mpg, aes(displ, hwy)) + geom_smooth() +
    geom_smooth(aes(displ, hwy_upr), color="green", data=smoothed) +
    geom_smooth(aes(displ, hwy_lwr), color="green", data=smoothed)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.6.2.1.png" alt="ggplot2-chap14.6.2.1.png" />
</p>
</div>


<ol class="org-ol">
<li value="2"><p>
What stats were used to create the following plots?
</p>

<p>
a.  This looks like <code>stat_ecdf()</code> used with either <code>geom_line()</code>
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, hwy)) +
    geom_line(stat="ecdf")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.6.2.2.png" alt="ggplot2-chap14.6.2.2.png" />
</p>
</div>

<p>
This is more stretched out than the scrunched up sample.
</p>

<p>
b.  This looks like a quantile stat used with <code>geom_point()</code>.
</p>

<p>
c.  This looks like a function plot for the recentered and scaled
    normal density compared to the data density.
</p></li>

<li value="3"><p>
Read the help for <code>stat_sum()</code> then use <code>geom_count()</code> to create a
plot that shows the proportion of cars that have each combination
of drv and trans.
</p>

<p>
TO DO
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org8a41fa3" class="outline-3">
<h3 id="org8a41fa3"><span class="section-number-3">7.5</span> 14.7.1 Exercises</h3>
<div class="outline-text-3" id="text-7-5">
<ol class="org-ol">
<li value="1"><p>
When might you use <code>position_nudge()</code>? Read the documentation.
</p>

<p>
From the help file:
     <code>position_nudge()</code> is generally useful for adjusting the position
  of items on discrete scales by a small amount. Nudging is built in
  to <code>geom_text()</code> because it's so useful for moving labels a small
  distance from what they're labelling.
</p></li>
</ol>

<div class="org-src-container">
<pre class="src src-R"> df &lt;- data.frame(
	x = c(1,3,2,5),
	y = c("a","c","d","c")
      )
 ggplot(df, aes(x, y)) +
	geom_point() +
geom_text(aes(label = y), position = position_nudge(y = -0.1))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.7.1.1.png" alt="ggplot2-chap14.7.1.1.png" />
</p>
</div>

<ol class="org-ol">
<li value="2"><p>
Many position adjustments can only be used with a few geoms. For
example, you can’t stack boxplots or errors bars. Why not? What
properties must a geom possess in order to be stackable? What
properties must it possess to be dodgeable?
</p>

<p>
I would say that you can't you can’t stack boxplots or errors bars
because they indicate a density or a distribution of values for a
category.  Stacking a distribution for more than one category doesn't
make much sense.
</p></li>

<li value="3"><p>
Why might you use <code>geom_jitter()</code> instead of <code>geom_count()</code>? What
are the advantages and disadvantages of each technique?
</p>

<p>
 This is a variant of <code>geom_point()</code> that counts the number of
 observations at each location, then maps the count to point area.
 It useful when you have discrete data and overplotting.  I would
 want this when I want more precise information.  On the other hand,
 using <code>geom_jitter()</code> gives a more impressionistic sense of the
data.
</p></li>

<li value="4">When might you use a stacked area plot? What are the advantages
and disadvantages compared to a line plot?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(color, fill = cut)) + 
   geom_bar(position = "identity", alpha = 1 / 2, colour = "grey50") +
      xlab(NULL) + ylab(NULL) + theme(legend.position = "none")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.7.1.4a.png" alt="ggplot2-chap14.7.1.4a.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(color, colour = cut)) + 
  geom_line(aes(group = cut), stat = "count") + 
  xlab(NULL) + ylab(NULL) + 
  theme(legend.position = "none")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap14.7.1.4b.png" alt="ggplot2-chap14.7.1.4b.png" />
</p>
</div>

<p>
I think the stacked obscures a lot of information, even with the
transparency. However the filled areas give an impression of the
relative numbers better than the line plots, which seem to be meager
on information, even though it is the same thing.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf28a84c" class="outline-2">
<h2 id="orgf28a84c"><span class="section-number-2">8</span> Chapter 15 &#x2013; Scales and guides</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>

<div id="outline-container-orgf586d5d" class="outline-3">
<h3 id="orgf586d5d"><span class="section-number-3">8.1</span> 15.1.1  Exercises</h3>
<div class="outline-text-3" id="text-8-1">
<ol class="org-ol">
<li value="1"><p>
Simplify the following plot specifications to make them easier to understand.
</p>

<p>
a.
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ)) + 
 scale_y_continuous("Highway mpg") + 
 scale_x_continuous() +
 geom_point(aes(y = hwy))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  scale_y_continuous("Highway mpg")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap15.1.1.1a.png" alt="ggplot2-chap15.1.1.1a.png" />
</p>
</div>

<p>
b.
</p>
<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(y = displ, x = class)) + 
scale_y_continuous("Displacement (l)") + 
scale_x_discrete("Car type") +
scale_x_discrete("Type of car") + 
scale_colour_discrete() + 
geom_point(aes(colour = drv)) + 
scale_colour_discrete("Drive\ntrain")
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(x = class, y = displ, colour = drv)) + 
  geom_point(aes()) + 
  scale_x_discrete("Type of car") + 
  scale_y_continuous("Displacement (l)") + 
  scale_colour_discrete("Drive\ntrain")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap15.1.1.1b.png" alt="ggplot2-chap15.1.1.1b.png" />
</p>
</div></li>

<li value="2"><p>
a. What happens if you pair a discrete variable with a continuous
scale?
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(x = class, y = displ, colour = drv)) + 
  geom_point(aes()) + 
  scale_x_continuous("Type of car") + 
  scale_y_continuous("Displacement (l)") + 
  scale_colour_discrete("Drive\ntrain")
</pre>
</div>

<p>
You get:
Error: Discrete value supplied to continuous scale
</p>

<p>
b.  What happens if you pair a continuous variable with a
discrete scale?
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(mpg, aes(x = class, y = displ, colour = drv)) + 
  geom_point(aes()) + 
  scale_x_discrete("Type of car") + 
  scale_y_discrete("Displacement (l)") + 
  scale_colour_discrete("Drive\ntrain")
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap15.1.1.2b.png" alt="ggplot2-chap15.1.1.2b.png" />
</p>
</div>

<p>
The plot comes put okay, but the continuous variable does not have any
scale marks on the axis.  
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org528e266" class="outline-3">
<h3 id="org528e266"><span class="section-number-3">8.2</span> 15.7 Exercises</h3>
<div class="outline-text-3" id="text-8-2">
<ol class="org-ol">
<li value="1"><p>
What are the three most important arguments that apply to both axes
and legends? What do they do? Compare and contrast their operation
for axes vs. legends.
</p>

<p>
From section 15.3:
</p></li>
</ol>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Argument</td>
<td class="org-left">Axis</td>
<td class="org-left">Legend</td>
</tr>

<tr>
<td class="org-left">name</td>
<td class="org-left">Label</td>
<td class="org-left">Title</td>
</tr>

<tr>
<td class="org-left">breaks</td>
<td class="org-left">Ticks  &amp; grid  line</td>
<td class="org-left">Key</td>
</tr>

<tr>
<td class="org-left">labels</td>
<td class="org-left">Tick label</td>
<td class="org-left">Key label</td>
</tr>
</tbody>
</table>
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga1291fe" class="outline-2">
<h2 id="orga1291fe"><span class="section-number-2">9</span> Chapter 17 &#x2013; Faceting</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org472ebb6" class="outline-3">
<h3 id="org472ebb6"><span class="section-number-3">9.1</span> 17.7 Exercises</h3>
<div class="outline-text-3" id="text-9-1">
<ol class="org-ol">
<li value="1">Diamonds: display the distribution of price conditional on cut
and carat. Try faceting by cut and grouping by carat. Try faceting
by carat and grouping by cut. Which do you prefer?</li>
</ol>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(carat, price)) +
  geom_point() +
  facet_wrap( ~cut)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap17.7.1.1.png" alt="ggplot2-chap17.7.1.1.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(cut, price )) +
  geom_point() +
  facet_wrap( ~carat)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap17.7.1.2.png" alt="ggplot2-chap17.7.1.2.png" />
</p>
</div>


<p>
Obviously, the first, conditional on cut is far preferable.  There are
too many values of carat to make a sensible facetplot.
</p>

<ol class="org-ol">
<li value="2"><p>
Diamonds: compare the relationship between price and carat for
each colour. What makes it hard to compare the groups? Is grouping
better or faceting? If you use faceting, what annotation might
you add to make it easier to see the differences between panels?
</p>

<div class="org-src-container">
<pre class="src src-R">ggplot(diamonds, aes(carat, price)) +
  geom_point() +
  geom_smooth(color="red") +
  facet_wrap( ~color)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap17.7.2.png" alt="ggplot2-chap17.7.2.png" />
</p>
</div>

<p>
Based on the partial results from the smoothing, it might help to add
the exponential rate for price increase.
</p></li>

<li value="3"><p>
Why is <code>facet_wrap()</code> generally more useful than <code>facet_grid()</code>?
</p>

<p>
<code>facet_wrap()</code> would seem to work well for categorical variables,
which are common, while <code>facet_grid()</code> seems to be a appropriate for
a variable with some kind of regular increase or decrease or
relationship among values.
</p></li>

<li value="4">Recreate the following plot. It facets mpg2 by class, overlaying
a smooth curve fit to the full dataset.</li>
</ol>

<blockquote>
<p>
<code>geom_smooth()</code> using method = 'loess' and formula 'y ~ x'
</p>
</blockquote>


<div class="org-src-container">
<pre class="src src-R">mpg2 &lt;- subset(mpg, cyl != 5 &amp; drv %in% c("4", "f") &amp; class != "2seater")
ggplot(mpg2, aes(displ, hwy)) +
  geom_point() +
  geom_smooth(se=FALSE) +
  facet_wrap( ~class)
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap17.7.3.png" alt="ggplot2-chap17.7.3.png" />
</p>
</div>

<p>
 I don't get the smoothed curve to extend over the range of the
displacement, and my smoothed curves seem to a lot of variation,
not very smoothed.  Must need to tweak a parameter.
</p>
<div class="org-src-container">
<pre class="src src-R">library(ggplot2)
options(crayon.enabled = FALSE) # see https://github.com/tidyverse/tibble/issues/395
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9494b36" class="outline-2">
<h2 id="org9494b36"><span class="section-number-2">10</span> Chapter 18 &#x2013; Themes</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgf3fa3d1" class="outline-3">
<h3 id="orgf3fa3d1"><span class="section-number-3">10.1</span> 18.2.1 Exercises</h3>
<div class="outline-text-3" id="text-10-1">
<ol class="org-ol">
<li value="1"><p>
Try out all the themes in ggthemes. Which do you like the best?
</p>

<p>
For examples in use, see
<a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">https://ggplot2.tidyverse.org/reference/ggtheme.html</a>
and
<a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a>
</p>

<p>
I haven't tried all the themes in ggthemes.  Among the 8 default
themes that come with ggplot2, I like <code>theme_linedraw()</code> the best,
since it seems to measure and indicate the data information most clearly, and it
resembles my understanding of classic graphs best. 
</p></li>

<li value="2"><p>
What aspects of the default theme do you like? What don’t you like?
What would you change?
</p>

<p>
 I like that colors "pop" against the grey background.  The lack of
axes conform to the Tufte admonition to minimize ink.
</p>

<p>
On the other hand, the grey background seems to me to be an
unnecessary use of additional ink.
</p>

<p>
For changes, I would make the <code>theme_linedraw()</code> the default, since
it conforms to my understanding of typical physical science and
engineering graphs.
</p></li>

<li value="3"><p>
Look at the plots in your favourite scientific journal. What
theme do they most resemble? What are the main differences?
</p>

<p>
I chose the Notices of the American Mathematical Society 2018
Survey of Faculty Salaries, in the February 2020 issue of the
Notices, Volume, 67, Number 2, page 242.  The AMS has an interest
in high quality mathematical typesetting and typogaphy, so it is a
good choice for me.  The graphs there appear to be closest to <code>theme_hc()</code>,
the Highcharts JS theme.  There is also a strong similarity to the
<code>theme_calc()</code>.
</p></li>
</ol>
</div>
</div>


<div id="outline-container-org26f0856" class="outline-3">
<h3 id="org26f0856"><span class="section-number-3">10.2</span> 18.4.6 Exercises</h3>
<div class="outline-text-3" id="text-10-2">
<ol class="org-ol">
<li value="1"><p>
Create the ugliest plot possible! (Contributed by Andrew
D. Steen, University of Tennessee - Knoxville)
</p>

<p>
Not going there!
</p></li>

<li value="2"><p>
<code>theme_dark()</code> makes the inside of the plot dark, but not the
outside. Change the plot background to black, and then update the
text settings so you can still read the labels.
</p>

<p>
I am not sure if this is asking to fill the border or the plot area.
</p>

<div class="org-src-container">
<pre class="src src-R">df &lt;- data.frame(x = 1:3, y = 1:3)
base &lt;- ggplot(df, aes(x, y)) + geom_point()
base_t &lt;- base +
labs(title = "This is a ggplot title line one\n This is a ggplot line two")
base_t + theme(plot.background=element_rect(fill="black"),
	       title=element_text(color="white"),
	       axis.text=element_text(colour="white"),
	       axis.title=element_text(colour="white"))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap18.4.6.2.png" alt="ggplot2-chap18.4.6.2.png" />
</p>
</div></li>
</ol>


<ol class="org-ol">
<li value="3"><p>
Make an elegant theme that uses “linen” as the background
colour and a serif font for the text.
</p>

<p>
Needs info from 18.3, particularly <code>element_rect()</code>,
<code>base + theme(panel.background = element_rect(fill = "linen"))</code>
</p>

<p>
Looks like I am going to need <code>element_text(family="serif")</code>
</p>

<p>
The following seems to work for an ad hoc solution.  To get a more
permanent solution, I would want to define a <code>theme_elegant()</code>.
</p>

<div class="org-src-container">
<pre class="src src-R">df &lt;- data.frame(x = 1:3, y = 1:3)
base &lt;- ggplot(df, aes(x, y)) + geom_point()
base_t &lt;- base +
labs(title = "This is a ggplot title line one\nThis is a ggplot line two") +
  theme(panel.background = element_rect(fill = "linen"),
	text=element_text(family="serif"))
base_t

</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap18.4.6.3.png" alt="ggplot2-chap18.4.6.3.png" />
</p>
</div></li>

<li value="4"><p>
Systematically explore the effects of <code>hjust</code> when you have a
multiline title. Why doesn’t <code>vjust</code> do anything?
</p>

<p>
First, default is left justified.
</p>
<div class="org-src-container">
<pre class="src src-R">df &lt;- data.frame(x = 1:3, y = 1:3)
base &lt;- ggplot(df, aes(x, y)) + geom_point()
base_t &lt;- base +
labs(title = "This is a ggplot title line one\nThis is a ggplot line two") +
xlab(NULL) + 
ylab(NULL)
base_t
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap18.4.6.4a.png" alt="ggplot2-chap18.4.6.4a.png" />
</p>
</div>

<p>
Second, with <code>hjust = 1</code>, title is right-justified.
</p>
<div class="org-src-container">
<pre class="src src-R">df &lt;- data.frame(x = 1:3, y = 1:3)
base &lt;- ggplot(df, aes(x, y)) + geom_point()
base_t &lt;- base +
labs(title = "This is a ggplot title line one\nThis is a ggplot line two") + 
xlab(NULL) + 
ylab(NULL)
base_t + theme(plot.title = element_text(hjust = 1))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap18.4.6.4b.png" alt="ggplot2-chap18.4.6.4b.png" />
</p>
</div>

<p>
Third with <code>hjust = 0.5</code>, title is centered
</p>
<div class="org-src-container">
<pre class="src src-R">df &lt;- data.frame(x = 1:3, y = 1:3)
base &lt;- ggplot(df, aes(x, y)) + geom_point()
base_t &lt;- base +
labs(title = "This is a ggplot title line one\nThis is a ggplot line two")+ 
xlab(NULL) + 
ylab(NULL)
base_t + theme(plot.title = element_text(hjust = 0.5))
</pre>
</div>


<div class="figure">
<p><img src="graphics/ggplot2-chap18.4.6.4c.png" alt="ggplot2-chap18.4.6.4c.png" />
</p>
</div></li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Steve Dunbar</p>
<p class="date">Created: 2021-03-08 Mon 10:32</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
